version: "3.9"
services:
  node:
    image: mcr.microsoft.com/playwright:v1.56.1
    command: ["npx", "playwright", "test"]
    # Mount your source code (adjust the path to your project)
    volumes:
      - ./:/home
      - ./screenshots:/home/screenshots
    entrypoint: /bin/sh -c "\
      cd /home && \
      npm ci && \
      npx playwright install --with-deps && \
      exec \"$@\""
    environment:
      - PLAYWRIGHT_BROWSERS_PATH=0   # use bundled browsers
    # Expose a port if you need to view a UI (e.g., a test server)
    ports:
      - "3000:3000"
    deploy:
      resources:
        limits:
          memory: 2G
